/* ===================== Azbry Chess — CSS FIX PRO MAX ===================== */

/* Palet */
:root{
  --sq-light: #EEEED2;        /* chess.com-ish light */
  --sq-dark:  #769656;        /* chess.com-ish dark  */
  --coord: rgba(255,255,255,.96);
  --coord-shadow: 0 1px 1px rgba(0,0,0,.55);
  --ring-last: rgba(0,0,0,.18);
  --ring-src:  rgba(255,255,255,.28);
  --ring-check: rgba(255,77,77,.9);
  --glow-check: rgba(255,77,77,.50);
}

/* ================= Papan ================= */
.board{
  position: relative;
  display: grid;
  grid-template-columns: repeat(8, 1fr);
  grid-template-rows: repeat(8, 1fr);
  width: 100%;
  aspect-ratio: 1/1;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 12px 40px rgba(0,0,0,.35);
  border: 1px solid rgba(0,0,0,.12);
}

/* Kotak */
.sq{
  position: relative;                 /* << penting utk .dot */
  display: grid;
  place-items: center;
  user-select: none;
  -webkit-user-select: none;
  font-size: clamp(42px, 9vw, 76px);
}
.sq.light{ background: var(--sq-light); }
.sq.dark { background: var(--sq-dark);  }

/* ================= Bidak ================= */
.piece{
  position: relative;
  z-index: 2;                         /* di atas koordinat & dot */
  line-height: 1;
  pointer-events: none;               /* klik tembus ke .sq */
}
.piece.white{
  color:#fff;
  text-shadow:
    0 0 2px #000,
    0 0 1px #000,
    0 1px 0 #000,
    1px 0 0 #000,
    -1px 0 0 #000,
    0 -1px 0 #000;
  filter: drop-shadow(0 0 2px rgba(0,0,0,.6));
}
.piece.black{
  color:#222;
  text-shadow: 0 0 3px rgba(255,255,255,.25);
}

/* ================= Koordinat (overlay) ================= */
/* Matikan label pseudo bila ada definisi lama */
.sq[data-rank="1"]::after,
.sq[data-file="a"]::before{ content:none !important; }

/* Huruf a–h (bawah, kanan-bawah tiap kolom) */
.board .files{
  position:absolute; inset:0;
  display:grid; grid-template-columns:repeat(8,1fr);
  pointer-events:none; z-index:1;
  font:700 12px/1 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
}
.board .files span{
  align-self:end; justify-self:end;
  padding:0 4px 4px 0;
  color:var(--coord);
  text-shadow:var(--coord-shadow);
}

/* Angka 8–1 (kiri, kiri-atas tiap baris) */
.board .ranks{
  position:absolute; inset:0;
  display:grid; grid-template-rows:repeat(8,1fr);
  pointer-events:none; z-index:1;
  font:700 12px/1 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
}
.board .ranks span{
  align-self:start; justify-self:start;
  padding:4px 0 0 4px;
  color:var(--coord);
  text-shadow:var(--coord-shadow);
}

/* ================= Legal move dot ================= */
.dot{
  position:absolute;
  width:22%;
  height:22%;
  border-radius:50%;
  top:50%; left:50%;
  transform:translate(-50%, -50%);
  background: rgba(102,204,255,.55);
  outline: 2px solid rgba(102,204,255,.35);
  box-shadow: 0 0 6px rgba(102,204,255,.35);
  pointer-events:none;                /* tidak blokir klik */
  z-index:1;
  transition: transform .12s ease, opacity .12s ease;
}
.dot.enter{ transform:translate(-50%,-50%) scale(1.15); opacity:.9; }

/* ================= Highlight ================= */
.sq.src  { box-shadow: inset 0 0 0 3px var(--ring-src);  }
.sq.last { box-shadow: inset 0 0 0 3px var(--ring-last); }

/* Raja diserang (check) */
.sq.check{
  box-shadow:
    inset 0 0 0 3px var(--ring-check),
    inset 0 0 18px var(--glow-check);
}

/* ================= Flip support ================= */
.board.flipped{ transform: rotate(180deg); }
.board.flipped .sq > *{ transform: rotate(180deg); }
.board.flipped .sq::before,
.board.flipped .sq::after{ transform: rotate(180deg); }

/* ================= Responsif ================= */
body.board-only .board-wrap{ max-width: min(98vw, 1100px); }

/* ===== (Opsional) area captured kalau kamu pakai ===== */
.captured-wrap{
  max-width: 820px; margin:10px auto 0;
  display:flex; align-items:center; gap:10px;
}
.captured{ display:flex; flex-wrap:wrap; gap:6px; }
.cap{ font-size:22px; line-height:1; filter:drop-shadow(0 1px 0 rgba(0,0,0,.25)); }
.cap-w{ color:#fff; text-shadow:0 0 2px #000; }
.cap-b{ color:#222; text-shadow:0 0 2px rgba(255,255,255,.35); }
.cap.new{ transform:scale(.8); opacity:.8; animation:pop .18s forwards; }
@keyframes pop{ to{ transform:scale(1); opacity:1; } }

/* ====== BOARD COORDINATES ====== */
#board{ position:relative; display:grid; grid-template-columns:repeat(8,1fr); aspect-ratio:1/1; gap:2px; }
#board .sq{ position:relative; display:flex; align-items:center; justify-content:center; }
#board .sq.light{ background:rgba(255,255,255,.06); }
#board .sq.dark{  background:rgba(0,0,0,.38); }

/* rank (1–8) di sisi kiri: elemen kolom pertama */
#board .sq:nth-child(8n+1)::before{
  content: attr(data-rank);
  position:absolute; left:6px; top:6px;
  font-size:11px; opacity:.7; letter-spacing:.2px;
}

/* file (a–h) di baris paling bawah: elemen 57..64 */
#board .sq:nth-child(n+57)::after{
  content: attr(data-file);
  position:absolute; right:6px; bottom:6px;
  font-size:11px; opacity:.7; letter-spacing:.2px;
}

/* ====== CAPTURED TRAYS ====== */
.captured{max-width:820px;margin:12px auto 0;display:grid;gap:8px}
.cap-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.cap-tray{
  display:flex;gap:6px;flex-wrap:wrap;min-height:28px;
  padding:8px 10px;border-radius:12px;
  background:var(--panel-bg-1);border:1px solid var(--panel-bd);
}
.cap-piece{font-size:20px;line-height:1;filter:drop-shadow(0 0 8px rgba(0,0,0,.35))}
