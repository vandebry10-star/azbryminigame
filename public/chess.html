<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Azbry Chess</title>

  <!-- Tema Azbry Chess -->
  <link rel="stylesheet" href="assets/css/chess.css" />
</head>
<body>
  <main id="chess-app" class="container">
    <!-- HEADER -->
    <header class="top-header">
      <div class="title">
        <span class="tag">AZBRY-MD â€¢ BOARD</span>
        <h1>Azbry Chess</h1>
      </div>
    </header>

    <!-- MODE PICKER -->
    <div class="mode-picker" aria-label="Pilih Mode">
      <button id="modeHuman" class="seg active" type="button">vs Human (Local)</button>
      <button id="modeAI" class="seg" type="button" aria-label="Mode vs Azbry-MD">vs Azbry-MD</button>
    </div>

    <!-- BOARD -->
    <section class="board-wrap" aria-label="Papan Catur">
      <div id="board" class="board" aria-live="polite"></div>
    </section>

    <!-- CONTROL PANEL -->
    <section class="panel" aria-label="Kontrol Permainan">
      <div class="controls">
        <button id="btnReset" class="btn accent" type="button">Muat Ulang</button>
        <button id="btnUndo" class="btn" type="button">Undo</button>
        <button id="btnRedo" class="btn" type="button">Redo</button>
        <button id="btnFlip" class="btn dark" type="button">Flip Board</button>
      </div>

      <div class="move-log">
        <h4>Riwayat Langkah</h4>
        <pre id="moveHistory">_</pre>
      </div>
    </section>

    <!-- FOOTER NAV -->
    <footer class="footer" role="navigation">
      <div class="left-btn">
        <button id="btnBoardOnly" class="btn dark" type="button">Board Only</button>
      </div>
      <div class="right-btn">
        <button id="btnBack" class="btn dark" type="button">Kembali</button>
      </div>
    </footer>
  </main>

  <!-- SCRIPTS (urut wajib) -->
  <script src="assets/js/chess-engine.js"></script>
  <script src="assets/js/chess-ui.js"></script>
  <script src="assets/js/main.js"></script>

  <!-- Lem perekat tipis supaya tombol dasar selalu hidup walau main.js belum kebaca -->
  <script>
    // Board Only toggle
    (function(){
      const byId = id => document.getElementById(id);
      const boardOnlyBtn = byId('btnBoardOnly');
      if (boardOnlyBtn) {
        boardOnlyBtn.addEventListener('click', () => {
          document.body.classList.toggle('board-only');
        });
      }

      // Kembali: prioritas history, fallback ke index.html
      const backBtn = byId('btnBack');
      if (backBtn) {
        backBtn.addEventListener('click', () => {
          if (history.length > 1) history.back();
          else window.location.href = 'index.html';
        });
      }

      // Flip Board (fallback; main.js juga mengikat ini)
      const flipBtn = byId('btnFlip');
      if (flipBtn) {
        flipBtn.addEventListener('click', () => {
          const b = byId('board');
          if (b) b.classList.toggle('flip');
          if (window.AzbryChess?.flipBoard) { try { window.AzbryChess.flipBoard(); } catch(e){} }
        });
      }

      // Mode buttons: set kelas aktif + panggil setter kalau ada
      const btnHuman = byId('modeHuman');
      const btnAI = byId('modeAI');
      function setActive(btn, other){
        btn.classList.add('active');
        other.classList.remove('active');
      }
      if (btnHuman && btnAI) {
        btnHuman.addEventListener('click', () => {
          setActive(btnHuman, btnAI);
          if (window.AzbryChess?.setMode) { try { window.AzbryChess.setMode('human'); } catch(e){} }
        });
        btnAI.addEventListener('click', () => {
          setActive(btnAI, btnHuman);
          if (window.AzbryChess?.setMode) { try { window.AzbryChess.setMode('ai'); } catch(e){} }
        });
      }
    })();
  </script>
</body>
</html>
