<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>Match-148 â€” Azbry MiniGames</title>

<!-- AZBRY GLOBAL THEME -->
<link rel="stylesheet" href="assets/css/azbry.css?v=20" />

<style>
  /* ===============================================
     Match-148 â€” Themed with Azbry Global Styles
     =============================================== */
  :root {
    --bg: var(--azbry-bg-1);
    --ink: var(--azbry-ink-soft);
    --accent: var(--azbry-accent);
    --accent2: var(--azbry-accent-2);
    --panel: var(--panel-bg-1);
    --bd: var(--panel-bd);
  }

  body {
    margin: 0;
    background: linear-gradient(180deg, var(--bg), var(--azbry-bg-2));
    color: var(--ink);
    font: 600 14px/1.4 system-ui, "Segoe UI", Roboto, Arial, sans-serif;
  }

  main.container {
    max-width: 1080px;
    margin: 0 auto;
    padding: 18px 16px 120px;
  }

  h1 {
    font-weight: 900;
    font-size: clamp(24px, 6vw, 38px);
    color: var(--accent);
    text-shadow: 0 0 18px var(--azbry-ring);
    margin: 0;
  }

  .title {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 14px;
  }

  .meta {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .pill {
    padding: 6px 10px;
    border-radius: var(--radius-12);
    background: var(--panel);
    border: 1px solid var(--bd);
    color: #cfd8e6;
  }

  .pill b {
    color: var(--accent);
  }

  .toolbar {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin: 10px 0 14px;
  }

  .btn {
    padding: 10px 14px;
    border-radius: var(--radius-12);
    border: 1px solid var(--bd);
    background: var(--panel);
    color: var(--ink);
    font-weight: 800;
    cursor: pointer;
    transition: 0.18s;
  }

  .btn.accent {
    background: linear-gradient(180deg, var(--accent), var(--accent2));
    color: var(--azbry-ink);
    border-color: transparent;
    box-shadow: 0 0 12px rgba(184, 255, 154, 0.35);
  }

  .game {
    position: relative;
    aspect-ratio: 1/1;
    width: min(96vw, 720px);
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
  }

  @media (min-width: 880px) {
    .game { gap: 12px; }
  }

  .card {
    position: relative;
    border-radius: 14px;
    perspective: 900px;
    user-select: none;
  }

  .face {
    position: absolute;
    inset: 0;
    display: grid;
    place-items: center;
    border-radius: 14px;
    backface-visibility: hidden;
    transform-style: preserve-3d;
    transition: transform 0.28s ease, box-shadow 0.18s ease;
    font-weight: 900;
  }

  .front {
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
    border: 1px solid var(--bd);
    font-size: clamp(18px, 5vw, 26px);
    color: #aeb9c8;
  }

  .back {
    transform: rotateY(180deg);
    background: linear-gradient(180deg, var(--panel-bg-1), rgba(184,255,154,.05));
    border: 1px solid rgba(184,255,154,.25);
    font-size: clamp(28px, 7vw, 44px);
    color: #101;
    text-shadow: 0 1px 0 rgba(255, 255, 255, .35);
  }

  .card.flip .front { transform: rotateY(180deg); }
  .card.flip .back  { transform: rotateY(0deg); }

  .card.good .back {
    box-shadow: 0 0 0 3px rgba(127, 255, 106, 0.55) inset,
                0 0 18px rgba(127, 255, 106, 0.35);
  }

  .card.bad .back {
    box-shadow: 0 0 0 3px rgba(255, 92, 122, 0.55) inset,
                0 0 18px rgba(255, 92, 122, 0.35);
  }

  .done { visibility: hidden; pointer-events: none; }

  .hint {
    text-align: center;
    margin: 8px auto 4px;
    color: #aeb9c8;
    opacity: 0.9;
    font-size: 13px;
  }

  /* Modal */
  .modal {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(11, 13, 16, 0.92);
    z-index: 9;
    opacity: 0;
    pointer-events: none;
    transition: .25s;
  }

  .modal.show {
    opacity: 1;
    pointer-events: auto;
  }

  .cardd {
    width: min(92vw, 540px);
    padding: 22px;
    border-radius: var(--radius-16);
    text-align: center;
    background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    border: 1px solid var(--bd);
    box-shadow: 0 20px 60px rgba(0,0,0,.45);
  }

  .cardd h2 {
    margin: 6px 0 8px;
    color: var(--accent);
    text-shadow: 0 0 16px var(--azbry-ring);
    font-size: clamp(22px, 4.6vw, 34px);
  }

  .sub {
    color: #cfd8e6;
    margin-bottom: 14px;
    opacity: .9;
  }

  .modal .row {
    display: flex;
    gap: 8px;
    justify-content: center;
    flex-wrap: wrap;
  }
</style>
</head>

<body>
  <main class="container">
    <div class="title">
      <h1>MATCH-148</h1>
      <div class="meta">
        <span class="pill">Target: <b>jumlah = 148</b></span>
        <span class="pill">Pairs: <b id="pairsLeft">8</b></span>
      </div>
    </div>

    <div class="toolbar">
      <button id="btnEasy" class="btn">Mudah (6Ã—2)</button>
      <button id="btnNormal" class="btn accent">Normal (8Ã—2)</button>
      <button id="btnHard" class="btn">Sulit (10Ã—2)</button>
      <button id="btnReset" class="btn">Reset</button>
    </div>

    <div class="hint">Balik dua kartu yang <b>jumlahnya 148</b> untuk menghapus pasangan. Selesaikan secepatnya!</div>

    <section id="board" class="game" aria-label="board"></section>

    <div class="toolbar" style="justify-content:center;margin-top:12px">
      <span class="pill">Waktu: <b id="time">0.00</b>s</span>
      <span class="pill">Langkah: <b id="moves">0</b></span>
      <span class="pill">Rekor: <b id="best">â€”</b></span>
    </div>
  </main>

  <!-- MODAL -->
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="cardd">
      <h2>Tuntas! ðŸ”¥</h2>
      <div class="sub">
        Waktu: <b id="statTime">0.00s</b> â€¢ Langkah: <b id="statMoves">0</b><br>
        Mode: <b id="statMode">Normal</b>
      </div>
      <div class="row">
        <button id="btnAgain" class="btn accent">Main Lagi</button>
        <button id="btnClose" class="btn">Tutup</button>
      </div>
    </div>
  </div>

<script>
/* =====================================================
   MATCH-148 â€” GAME LOGIC
   ===================================================== */
(function(){
  const TARGET = 148;
  const $board   = document.getElementById('board');
  const $pairs   = document.getElementById('pairsLeft');
  const $time    = document.getElementById('time');
  const $moves   = document.getElementById('moves');
  const $best    = document.getElementById('best');
  const $modal   = document.getElementById('modal');
  const $statT   = document.getElementById('statTime');
  const $statM   = document.getElementById('statMoves');
  const $statMd  = document.getElementById('statMode');
  const $btnAgain= document.getElementById('btnAgain');
  const $btnClose= document.getElementById('btnClose');

  const btnEasy   = document.getElementById('btnEasy');
  const btnNormal = document.getElementById('btnNormal');
  const btnHard   = document.getElementById('btnHard');
  const btnReset  = document.getElementById('btnReset');

  let PAIRS = 8;
  let deck = [], flipped = [], locked = false;
  let pairsLeft = PAIRS, moves = 0;
  let t0 = 0, rafId = 0, running = false;
  let modeName = 'Normal';

  function r(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
  function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
  function fmt(x){ return (Math.round(x*100)/100).toFixed(2); }

  function setGridByPairs(pairs){
    if (pairs===6){ $board.style.gridTemplateColumns='repeat(3,1fr)'; }
    else { $board.style.gridTemplateColumns='repeat(4,1fr)'; }
  }

  function genPairs(pairs){
    const set = new Set();
    while(set.size < pairs){
      let k = r(12,136);
      if (k===TARGET/2) continue;
      if (set.has(k) || set.has(TARGET-k)) continue;
      set.add(k);
    }
    const arr = [...set].flatMap(k => [k, TARGET-k]);
    return shuffle(arr);
  }

  function buildBoard(){
    $board.innerHTML='';
    deck = genPairs(PAIRS).map((n,i)=>({n,id:i+'_'+n}));
    pairsLeft = PAIRS; moves=0; flipped=[]; locked=false;
    $pairs.textContent=pairsLeft; $moves.textContent=moves;
    setGridByPairs(PAIRS);

    deck.forEach((card)=>{
      const cell=document.createElement('div');
      cell.className='card';
      cell.dataset.n=card.n;

      const f1=document.createElement('div');
      f1.className='face front'; f1.textContent='148';
      const f2=document.createElement('div');
      f2.className='face back'; f2.textContent=card.n;

      cell.appendChild(f1); cell.appendChild(f2);
      cell.addEventListener('click', onFlip, {passive:true});
      $board.appendChild(cell);
    });
  }

  function onFlip(e){
    const el=e.currentTarget;
    if (locked || el.classList.contains('flip') || el.classList.contains('done')) return;
    if (!running) startTimer();

    el.classList.add('flip');
    flipped.push(el);

    if (flipped.length===2){
      locked=true; moves++; $moves.textContent=moves;
      const a=parseInt(flipped[0].dataset.n,10);
      const b=parseInt(flipped[1].dataset.n,10);
      const ok=(a+b===TARGET);
      flipped.forEach(x=>x.classList.add(ok?'good':'bad'));

      setTimeout(()=>{
        if (ok){
          flipped.forEach(x=>{x.classList.remove('good','flip');x.classList.add('done');});
          pairsLeft--; $pairs.textContent=pairsLeft;
          if (!pairsLeft) finish();
        }else{
          flipped.forEach(x=>x.classList.remove('bad','flip'));
        }
        flipped=[]; locked=false;
      },500);
    }
  }

  function startTimer(){
    running=true; t0=performance.now();
    const tick=(now)=>{
      const t=(now-t0)/1000;
      $time.textContent=fmt(t);
      rafId=requestAnimationFrame(tick);
    };
    rafId=requestAnimationFrame(tick);
  }

  function stopTimer(){ running=false; cancelAnimationFrame(rafId); }

  function finish(){
    stopTimer();
    const t=parseFloat($time.textContent);
    $statT.textContent=fmt(t)+'s'; $statM.textContent=moves; $statMd.textContent=modeName;

    const key='match148_best_'+modeName;
    const prev=localStorage.getItem(key);
    if (!prev || t<parseFloat(prev)) localStorage.setItem(key,t.toString());
    const best=localStorage.getItem(key);
    $best.textContent=best?fmt(parseFloat(best))+'s':'â€”';

    $modal.classList.add('show');
  }

  function resetGame(){
    stopTimer(); $time.textContent='0.00';
    buildBoard();
  }

  btnEasy.onclick=()=>{setMode('Easy',6,btnEasy);};
  btnNormal.onclick=()=>{setMode('Normal',8,btnNormal);};
  btnHard.onclick=()=>{setMode('Sulit',10,btnHard);};
  btnReset.onclick=resetGame;

  function setMode(name,pairs,btn){
    [btnEasy,btnNormal,btnHard].forEach(b=>b.classList.remove('accent'));
    btn.classList.add('accent');
    PAIRS=pairs; modeName=name; resetGame();
  }

  $btnAgain.onclick=()=>{$modal.classList.remove('show');resetGame();};
  $btnClose.onclick=()=>{$modal.classList.remove('show');};

  const best=localStorage.getItem('match148_best_'+modeName);
  $best.textContent=best?fmt(parseFloat(best))+'s':'â€”';
  buildBoard();
})();
</script>
</body>
</html>
